<!DOCTYPE HTML>
<html>

<head>
    <meta name="viewport" content="width=320, user-scalable=no" />
    <meta http-equiv="Content-type" content="text/html, charset=utf-8">
    <title></title>
  

<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="css/jquery.mobile-1.3.2.min.css" />
<script src="js/jquery-1.9.1.min.js"></script>
<script src="js/jquery.mobile-1.3.2.min.js"></script>

<link rel="stylesheet" type="text/css" href="css/main.css" />
</head>

<script type="text/javascript">
	sessionStorage.setItem("serverDomain", "http://diserver.id.tue.nl:8080/EServer");
	function sendData() {
	  var form = $("#loginForm");    
		  var u = $("#username", form).val();
		  var p = $("#password", form).val();
		 var address = sessionStorage.getItem("serverDomain") + "/login?";
		 $.ajax({
		        type       : "GET",
		        url        : sessionStorage.getItem("serverDomain") + "/login?",
		        crossDomain: true,
		        beforeSend : function() {$.mobile.loading('show')},
		        complete   : function() {$.mobile.loading('hide')},
		        data       : {username : u, password : p},
		        dataType   : 'json',
		        success    : function(data) {
		        	sessionStorage.setItem("usertoken", data.members.token);
		        	sessionStorage.setItem("currentUser", u);
		        	window.location.replace('foodList.html');
		        },
		        error      : function(e) {
		        	//TODO phonegap alerts
		           navigator.notification.alert(e);
		           navigator.notification.alert(address);
		           
		        }
		    });    
		 return false; 
		 //showAlert();
		//navigator.notification.alert("PhoneGap is working!!");
	}
	function openRegister() {		 
		window.location.href = "register.html";
		//$.mobile.changePage("register.html")
	}
	
	// alert dialog dismissed
    function alertDismissed() {
        // do something
    }

// Show a custom alertDismissed
//
function showAlert() {
    navigator.notification.alert(
        'You are the winner!',  // message
        alertDismissed,         // callback
        'Game Over',            // title
        'Done'                  // buttonName
    );
}
	
</script>
<body>
<div  class="app">
		<style>
#email .ui-icon {
	background: url("img/Toolbar1.png");
	background-size: 35px 35px;
}
#pen .ui-icon {
	background: url("img/Toolbar2.png");
	background-size: 35px 35px;
}
#io .ui-icon {
	background: url("img/Toolbar3.png");
		background-size: 35px 35px;
}
#trash .ui-icon {
	background: url("img/Toolbar4.png");
		background-size: 35px 35px;
}
#friends .ui-icon {
	background: url("img/Toolbar5.png");
		background-size: 35px 35px;
}
</style>
<div id="loginPage" data-role="page" data-theme="a">

    <div data-role="header">
        <h1>Euphoria</h1>
    </div>

    <div data-role="content">    

        <form id="loginForm">
        <div data-role="fieldcontain" class="ui-hide-label">
            <label for="username">Username:</label>
            <input type="text" name="username" id="username" value="" placeholder="Username" />
        </div>
        <div data-role="fieldcontain" class="ui-hide-label">
            <label for="password">Password:</label>
            <input type="password" name="password" id="password" value="" placeholder="Password" />
        </div>	
        <div class="ui-grid-a">	
		<div class="ui-block-a">
        	<input type="submit" value="Login" id="submitButton" onclick="sendData(); return false;">
        </div>
        <div class="ui-block-b">
        	<input type="submit" value="Register" id="regButton" onclick="openRegister();">
        </div>
         </div>
        </form>
        
    </div>

</div>
</div>
 <script type="text/javascript" src="phonegap.js"></script>
</body>
</html>