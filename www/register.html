<!DOCTYPE HTML>
<html>

<head>
    <meta name="viewport" content="width=320, user-scalable=no" />
    <meta http-equiv="Content-type" content="text/html, charset=utf-8">
    <title></title>
  

<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="css/jquery.mobile-1.3.2.min.css" />
<script src="js/jquery-1.9.1.min.js"></script>
<script src="js/jquery.mobile-1.3.2.min.js"></script>

<link rel="stylesheet" type="text/css" href="css/main.css" />
</head>

<script type="text/javascript">        
        
        function register() {
                var form = $("#registerform");
                var u = $("#username", form).val();
                var e = $("#email", form).val();
                var p = $("#password", form).val();
                var pr = $("#passwordRepeat", form).val();
         $.ajax({
                        type : "GET",
                        url : sessionStorage.getItem("serverDomain") + "/register?",
                        crossDomain : true,
                        beforeSend : function() {
                                $.mobile.loading('show')
                        },
                        complete : function() {
                                $.mobile.loading('hide')
                        },
                        data : {
                                username : u,
                                password : p,
                                passwordRepeat : pr,
                                email : e
                        },
                        dataType : 'json',
                        success : function(data) {
                                if (data.members.value != 'ok') {
                                        navigator.notification.alert(data.members.value);
                                        console.log("failure!");
                                } else {
                                        sessionStorage.setItem("usertoken", data.members.token);
                                        window.location.replace('foodList.html');
                                }
                                 console.log("success!");
                        },
                        error : function(err) {
                                navigator.notification.alert(err);
                                console.log("failure!");
                        }
                }); 
                return false;
        }
</script>

<body>
<div  class="app">  
<div id="loginPage" data-role="page" data-theme="a">

    <div data-role="header">
        <h1>Euphoria</h1>
    </div>
    <div data-role="content">    

        <form id="registerform">
        <div data-role="fieldcontain" class="ui-hide-label">
            <label for="username">Username:</label>
            <input type="text" name="username" id="username" value="" placeholder="Username" />
        </div>
                 <div data-role="fieldcontain" class="ui-hide-label">
            <label for="email">E-mail:</label>
            <input type="text" name="email" id="email" value="" placeholder="E-mail" />
        </div>
        <div data-role="fieldcontain" class="ui-hide-label">
            <label for="password">Password:</label>
            <input type="password" name="password" id="password" value="" placeholder="Password" />
        </div>
       
        <div data-role="fieldcontain" class="ui-hide-label">
            <label for="passwordRepeat">Password:</label>
            <input type="password" name="passwordRepeat" id="passwordRepeat" value="" placeholder="Repeat Password" />
        </div>
                  <div class="ui-grid-a">        
                <div class="ui-block-a">
                <input type="submit" value="Register" id="registerButton" onclick="register(); return false;">
                
        </div>
        <div class="ui-block-b">
                <input type="submit" value="Login" id="loginButton" onclick="window.location.href = 'login.html'; return false;">
        </div>
        </div>
        </form>        
    </div>
</div>
</div>
 <script type="text/javascript" src="cordova.js"></script>
</body>
</html>